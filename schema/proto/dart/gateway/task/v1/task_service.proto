syntax = "proto3";

package dart.gateway.task.v1;

import "google/api/annotations.proto";
import "google/api/field_behavior.proto";
import "google/api/resource.proto";
import "google/protobuf/field_mask.proto";
import "google/protobuf/empty.proto";
import "dart/gateway/task/v1/task.proto";

option go_package = "github.com/10Narratives/dart/pkg/dart/gateway/task/v1;task";

service TaskService {
  // Lists tasks for a specific agent.
  rpc ListTasks(ListTasksRequest) returns (ListTasksResponse) {
    option (google.api.http) = {
      get : "/v1alpha1/{parent=projects/*/agents/*}/tasks"
    };
  }

  // Gets details of a specific task.
  rpc GetTask(GetTaskRequest) returns (Task) {
    option (google.api.http) = {
      get : "/v1alpha1/{name=projects/*/agents/*/tasks/*}"
    };
  }

  // Creates a new task.
  rpc CreateTask(CreateTaskRequest) returns (Task) {
    option (google.api.http) = {
      post : "/v1alpha1/{parent=projects/*/agents/*}/tasks"
      body : "task"
    };
  }

  // Cancels a running task.
  rpc CancelTask(CancelTaskRequest) returns (Task) {
    option (google.api.http) = {
      post : "/v1alpha1/{name=projects/*/agents/*/tasks/*}:cancel"
      body : "*"
    };
  }
}

message ListTasksRequest {
  // Required. The agent to list tasks from.
  // Format: `projects/{project}/agents/{agent}`
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference).type = "dart.gateway/Agent"
  ];

  // The maximum number of tasks to return.
  int32 page_size = 2 [ (google.api.field_behavior) = OPTIONAL ];

  // A page token, received from a previous `ListTasks` call.
  string page_token = 3 [ (google.api.field_behavior) = OPTIONAL ];
}

message ListTasksResponse {
  // The list of tasks.
  repeated Task tasks = 1;

  // A token to retrieve the next page of results.
  string next_page_token = 2;
}

message GetTaskRequest {
  // Required. The resource name of the task to retrieve.
  // Format: `projects/{project}/agents/{agent}/tasks/{task}`
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference).type = "dart.gateway/Task"
  ];
}

message CreateTaskRequest {
  // Required. The agent to create a task in.
  // Format: `projects/{project}/agents/{agent}`
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference).type = "dart.gateway/Agent"
  ];

  // Optional. The task ID to use. If not provided, the system will generate
  // one.
  string task_id = 2 [ (google.api.field_behavior) = OPTIONAL ];

  // Required. The task to create.
  Task task = 3 [ (google.api.field_behavior) = REQUIRED ];
}

message CancelTaskRequest {
  // Required. The resource name of the task to cancel.
  // Format: `projects/{project}/agents/{agent}/tasks/{task}`
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference).type = "dart.gateway/Task"
  ];
}